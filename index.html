<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FL Studio Wallpaper App</title>
  <link rel="stylesheet" href="style.css">

  <!-- Initialize the WallpaperApp namespace properly -->
  <script>
    window.WallpaperApp = {
      registerModule: function(name, module) {
        console.log('Registered module:', name);
        this[name] = module;
      },
      UI: {
        showNotification: function(message, type) {
          // Create notification element
          const notification = document.createElement('div');
          notification.className = `notification ${type || 'info'}`;
          notification.innerHTML = `<div class="notification-content">${message}</div>`;

          // Add to container
          const container = document.getElementById('notification-container');
          if (container) {
            container.appendChild(notification);

            // Show notification with animation
            setTimeout(() => {
              notification.classList.add('show');
            }, 10);

            // Auto-remove after 3 seconds
            setTimeout(() => {
              notification.classList.remove('show');
              setTimeout(() => {
                notification.remove();
              }, 300);
            }, 3000);
          } else {
            console.log(`Notification (${type}): ${message}`);
          }
        },
        showTooltip: function() {},
        hideTooltip: function() {},
        showModal: function() {}
      },
      Logger: {
        info: function(msg) { console.log('[INFO]', msg); },
        error: function(msg, error) { console.error('[ERROR]', msg, error); },
        warn: function(msg) { console.warn('[WARN]', msg); }
      }
    };

    // Simulate Utils namespace for testing
    window.Utils = {
      Storage: {
        saveToLocalStorage: function(key, value) {
          try {
            localStorage.setItem(key, JSON.stringify(value));
          } catch (e) {
            console.error('Failed to save to localStorage:', e);
          }
        },
        loadFromLocalStorage: function(key) {
          try {
            const value = localStorage.getItem(key);
            return value ? JSON.parse(value) : null;
          } catch (e) {
            console.error('Failed to load from localStorage:', e);
            return null;
          }
        }
      },
      DOM: {
        clearElement: function(element) {
          while (element.firstChild) {
            element.removeChild(element.firstChild);
          }
        },
        addTooltip: function(element, text) {
          element.setAttribute('data-tooltip', text);
        }
      },
      String: {
        generateRandomId: function() {
          return Math.random().toString(36).substring(2, 10);
        }
      }
    };
  </script>
</head>
<body style="overflow: hidden;">
<!-- Main Application Container -->
<div id="app-container">
  <!-- Dynamic Background Container -->
  <div id="background-container" class="module-container">
    <!-- Background will be dynamically generated here -->
  </div>

  <!-- Media Display Container -->
  <div id="media-container" class="module-container">
    <!-- Media content will be displayed here -->
  </div>

  <!-- Audio Visualizer Container -->
  <div id="visualizer-container" class="module-container">
    <!-- Audio visualizer will be rendered here -->
  </div>

  <!-- Menu Hover Area and Trigger -->
  <div class="menu-hover-area">
    <div id="menu-trigger" class="menu-trigger right">
      <div class="trigger-indicator"></div>
    </div>
  </div>

  <!-- Main Menu - Now properly structured -->
  <div id="main-menu" class="slide-menu right">
    <div class="menu-header">
      <h1>CLUTCHBOYZ üåê</h1>
      <div class="menu-close">&times;</div>
    </div>
    <div class="menu-content">
      <div class="menu-section" data-section="background">
        <h2 style="display: flex; justify-content: center; align-items: center;">MENU</h2>
        <hr class="divider">
        <div class="category-item" data-action="import-media">MEDIA PLAYER</div>
        <div class="category-item" data-action="transitions">TRANSITIONS</div>
        <div class="category-item" data-action="effects">EFFECTS</div>
        <hr class="divider">
        <div class="category-item" data-action="daw-integration">DAW INTEGRATION</div>
        <div class="category-item" data-action="performance">PERFORMANCE</div>
        <div class="category-item" data-action="extra">EXTRA</div>
        <hr class="divider">
        <div class="category-item" data-action="config-settings">CONFIG SETTINGS</div>
        <div class="category-item" data-action="menu-settings">MENU SETTINGS</div>
        <div class="category-item" data-action="about">ABOUT</div>
        <hr class="divider">
      </div>
    </div>
    <div class="menu-footer">
      <div class="version-info">v0.1.0</div>
    </div>
  </div>

  <!-- Submenu Wrapper - Properly positioned outside of main menu -->
  <div class="submenu-wrapper">
    <!-- Import Media Submenu -->
    <div id="import-media-submenu" class="slide-submenu">
      <div class="menu-header">
        <h1>IMPORT MEDIA</h1>
        <div class="menu-close submenu-close">&times;</div>
      </div>
      <div class="menu-content">
        <div class="menu-section">
          <div class="category-item submenu-item" data-action="import-media">IMPORT MEDIA</div>
        </div>
      </div>
      <div class="menu-footer">
      </div>
    </div>

    <!-- Transitions Submenu -->
    <div id="transitions-submenu" class="slide-submenu">
      <div class="menu-header">
        <h1>TRANSITIONS</h1>
        <div class="menu-close submenu-close">&times;</div>
      </div>
      <div class="menu-content">
        <div class="menu-section">
          <div class="category-item submenu-item" data-action="fade-transition">FADE</div>
          <div class="category-item submenu-item" data-action="slide-transition">SLIDE</div>
          <div class="category-item submenu-item" data-action="zoom-transition">ZOOM</div>
          <div class="category-item submenu-item" data-action="dissolve-transition">DISSOLVE</div>
          <div class="category-item submenu-item" data-action="custom-transition">CUSTOM</div>
        </div>
      </div>
      <div class="menu-footer">
      </div>
    </div>

    <!-- Effects Submenu -->
    <div id="effects-submenu" class="slide-submenu">
      <div class="menu-header">
        <h1>EFFECTS</h1>
        <div class="menu-close submenu-close">&times;</div>
      </div>
      <div class="menu-content">
        <div class="menu-section">
          <div class="category-item submenu-item" data-action="blur-effect">BLUR</div>
          <div class="category-item submenu-item" data-action="glow-effect">GLOW</div>
          <div class="category-item submenu-item" data-action="particle-effect">PARTICLES</div>
          <div class="category-item submenu-item" data-action="color-effect">COLOR FILTERS</div>
          <div class="category-item submenu-item" data-action="distortion-effect">DISTORTION</div>
        </div>
      </div>
      <div class="menu-footer">
      </div>
    </div>

    <!-- DAW Integration Submenu -->
    <div id="daw-integration-submenu" class="slide-submenu">
      <div class="menu-header">
        <h1>DAW INTEGRATION</h1>
        <div class="menu-close submenu-close">&times;</div>
      </div>
      <div class="menu-content">
        <div class="menu-section">
          <div class="category-item submenu-item" data-action="fl-studio-connection">FL STUDIO</div>
          <div class="category-item submenu-item" data-action="ableton-connection">ABLETON LIVE</div>
          <div class="category-item submenu-item" data-action="logic-connection">LOGIC PRO</div>
          <div class="category-item submenu-item" data-action="pro-tools-connection">PRO TOOLS</div>
          <div class="category-item submenu-item" data-action="custom-daw-connection">CUSTOM DAW</div>
        </div>
      </div>
      <div class="menu-footer">
      </div>
    </div>

    <!-- Performance Submenu -->
    <div id="performance-submenu" class="slide-submenu">
      <div class="menu-header">
        <h1>PERFORMANCE</h1>
        <div class="menu-close submenu-close">&times;</div>
      </div>
      <div class="menu-content">
        <div class="menu-section">
          <div class="category-item submenu-item" data-action="1">1</div>
          <div class="category-item submenu-item" data-action="2">2</div>
          <div class="category-item submenu-item" data-action="3">3</div>
          <div class="category-item submenu-item" data-action="4">4</div>
          <div class="category-item submenu-item" data-action="5">5</div>
        </div>
      </div>
      <div class="menu-footer">
      </div>
    </div>

    <!-- Extra Submenu -->
    <div id="extra-submenu" class="slide-submenu">
      <div class="menu-header">
        <h1>EXTRA</h1>
        <div class="menu-close submenu-close">&times;</div>
      </div>
      <div class="menu-content">
        <div class="menu-section">
          <div class="category-item submenu-item" data-action="visualizer-styles">VISUALIZER STYLES</div>
          <div class="category-item submenu-item" data-action="clock-display">CLOCK DISPLAY</div>
          <div class="category-item submenu-item" data-action="spectrum-analyzer">SPECTRUM ANALYZER</div>
          <div class="category-item submenu-item" data-action="weather-widget">WEATHER WIDGET</div>
          <div class="category-item submenu-item" data-action="custom-widgets">CUSTOM WIDGETS</div>
        </div>
      </div>
      <div class="menu-footer">
      </div>
    </div>

    <!-- Config Settings Submenu -->
    <div id="config-settings-submenu" class="slide-submenu">
      <div class="menu-header">
        <h1>CONFIG SETTINGS</h1>
        <div class="menu-close submenu-close">&times;</div>
      </div>
      <div class="menu-content">
        <div class="menu-section">
          <div class="category-item submenu-item" data-action="startup-behavior">STARTUP BEHAVIOR</div>
          <div class="category-item submenu-item" data-action="auto-save">AUTO SAVE</div>
          <div class="category-item submenu-item" data-action="file-management">FILE MANAGEMENT</div>
          <div class="category-item submenu-item" data-action="keyboard-shortcuts">KEYBOARD SHORTCUTS</div>
          <div class="category-item submenu-item" data-action="reset-defaults">RESET TO DEFAULTS</div>
        </div>
      </div>
      <div class="menu-footer">
      </div>
    </div>

    <!-- Menu Settings Submenu -->
    <div id="menu-settings-submenu" class="slide-submenu">
      <div class="menu-header">
        <h1>MENU SETTINGS</h1>
        <div class="menu-close submenu-close">&times;</div>
      </div>
      <div class="menu-content">
        <div class="menu-section">
          <div class="category-item submenu-item" data-action="menu-position">MENU POSITION</div>
          <div class="category-item submenu-item" data-action="menu-opacity">MENU OPACITY</div>
          <div class="category-item submenu-item" data-action="menu-color-theme">COLOR THEME</div>
          <div class="category-item submenu-item" data-action="menu-animations">MENU ANIMATIONS</div>
          <div class="category-item submenu-item" data-action="customize-menu">CUSTOMIZE MENU</div>
        </div>
      </div>
      <div class="menu-footer">
      </div>
    </div>

    <!-- About Submenu -->
    <div id="about-submenu" class="slide-submenu">
      <div class="menu-header">
        <h1>ABOUT</h1>
        <div class="menu-close submenu-close">&times;</div>
      </div>
      <div class="menu-content">
        <div class="menu-section">
          <div class="category-item submenu-item" data-action="app-info">APP INFORMATION</div>
          <div class="category-item submenu-item" data-action="release-notes">RELEASE NOTES</div>
          <div class="category-item submenu-item" data-action="credits">CREDITS</div>
          <div class="category-item submenu-item" data-action="license">LICENSE INFO</div>
          <div class="category-item submenu-item" data-action="contact-support">CONTACT SUPPORT</div>
        </div>
      </div>
      <div class="menu-footer">
      </div>
    </div>
  </div>

  <!-- Tooltip Container -->
  <div id="tooltip-container"></div>

  <!-- Notification Container -->
  <div id="notification-container"></div>

  <!-- Modal Container -->
  <div id="modal-container"></div>
</div>

<!-- Main application script -->
<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Show welcome notification
    WallpaperApp.UI.showNotification('FL Studio Wallpaper App ready!', 'success');

    // Initialize app functionality immediately
    setupBasicMenuFunctionality();

    // Basic menu functionality
    function setupBasicMenuFunctionality() {
      const menuTrigger = document.getElementById('menu-trigger');
      const mainMenu = document.getElementById('main-menu');
      const menuClose = document.querySelector('#main-menu .menu-close');
      const categoryItems = document.querySelectorAll('#main-menu .category-item');
      const submenuCloseButtons = document.querySelectorAll('.submenu-close');
      const backButtons = document.querySelectorAll('.back-button');

      // Function to close all submenus
      function closeAllSubmenus() {
        const allSubmenus = document.querySelectorAll('.slide-submenu');
        const submenuWrapper = document.querySelector('.submenu-wrapper');

        if (submenuWrapper && submenuWrapper.classList.contains('active')) {
          // First, tell the wrapper to animate its width to 0
          submenuWrapper.classList.remove('active');

          // Listen for the transition end event
          submenuWrapper.addEventListener('transitionend', function hideSubmenus() {
            // After the width animation is complete, then hide all submenus
            allSubmenus.forEach(submenu => {
              submenu.classList.remove('active');
            });

            // Remove the event listener to avoid memory leaks
            submenuWrapper.removeEventListener('transitionend', hideSubmenus);
          }, { once: true }); // Using once: true ensures the listener is auto-removed after first execution
        } else {
          // If the wrapper is not active, just hide all submenus directly
          allSubmenus.forEach(submenu => {
            submenu.classList.remove('active');
          });
        }
      }

      // Toggle main menu
      menuTrigger.addEventListener('click', () => {
        mainMenu.classList.toggle('active');
      });

      // Close menu button
      menuClose.addEventListener('click', () => {
        mainMenu.classList.remove('active');
        closeAllSubmenus();
      });

      // Menu item click event to open submenus with proper sliding animation
      categoryItems.forEach(item => {
        item.addEventListener('click', () => {
          const action = item.getAttribute('data-action');
          const submenuId = `${action}-submenu`;
          const newSubmenu = document.getElementById(submenuId);
          const submenuWrapper = document.querySelector('.submenu-wrapper');
          const currentActiveSubmenu = document.querySelector('.slide-submenu.active');

          if (newSubmenu) {
            // Clear any previously selected items
            categoryItems.forEach(catItem => {
              catItem.classList.remove('selected');
            });
            item.classList.add('selected');

            // If we're switching between different submenus
            if (currentActiveSubmenu && currentActiveSubmenu !== newSubmenu) {
              // First, slide the wrapper out by removing the active class
              submenuWrapper.classList.remove('active');

              // Wait for the slide-out animation to complete
              submenuWrapper.addEventListener('transitionend', function switchSubmenu() {
                // Remove active class from current submenu
                currentActiveSubmenu.classList.remove('active');

                // Add active class to the new submenu
                newSubmenu.classList.add('active');

                // Start the slide-in animation
                setTimeout(() => {
                  submenuWrapper.classList.add('active');
                }, 10);

                // Remove this event listener to prevent multiple executions
                submenuWrapper.removeEventListener('transitionend', switchSubmenu);

                WallpaperApp.UI.showNotification(`Opened ${action} submenu`, 'info');
              }, { once: true });
            }
            // If there's no active submenu or it's the same one (toggling)
            else {
              // If this submenu is already active, just close it
              if (newSubmenu.classList.contains('active')) {
                closeAllSubmenus();
              }
              // Otherwise open it as normal
              else {
                newSubmenu.classList.add('active');
                submenuWrapper.classList.add('active');
                WallpaperApp.UI.showNotification(`Opened ${action} submenu`, 'info');
              }
            }
          }
        });
      });

      // Back button click events
      backButtons.forEach(button => {
        button.addEventListener('click', () => {
          closeAllSubmenus();
        });
      });

      // Submenu close button click events
      submenuCloseButtons.forEach(button => {
        button.addEventListener('click', () => {
          closeAllSubmenus();
        });
      });

      // ESC key to close menus
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
          const activeSubmenus = document.querySelectorAll('.slide-submenu.active');
          if (activeSubmenus.length > 0) {
            closeAllSubmenus();
          } else {
            mainMenu.classList.remove('active');
          }
        }
      });
    }
  });
</script>

<script src="media-importer.js"></script>

</body>
</html>
